<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TradeWars - Stock Trading Simulator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const TradingSimulator = () => {
            const [view, setView] = useState('plan-select');
            const [plan, setPlan] = useState(null);
            const [userName, setUserName] = useState('');
            const [currentUserId, setCurrentUserId] = useState(null);
            const [contribution, setContribution] = useState('');

            const [competitionCode, setCompetitionCode] = useState('');
            const [joinCode, setJoinCode] = useState('');
            const [copySuccess, setCopySuccess] = useState(false);
            const [competition, setCompetition] = useState(null);

            const [watchlist, setWatchlist] = useState([]);
            const [stocks, setStocks] = useState([]);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [lastUpdate, setLastUpdate] = useState(null);

            const [searchQuery, setSearchQuery] = useState('');
            const [searchResults, setSearchResults] = useState([]);
            const [searching, setSearching] = useState(false);
            const [showSearchResults, setShowSearchResults] = useState(false);

            const [selectedStock, setSelectedStock] = useState(null);
            const [quantity, setQuantity] = useState(1);
            const [searchTerm, setSearchTerm] = useState('');
            const [activeTab, setActiveTab] = useState('market');

            const COMMISSION_RATE = 0.03;
            const ALPHA_VANTAGE_KEY = 'KBWH9DJSWKX6UZ53';

            const POPULAR_STOCKS = [
                'AAPL', 'GOOGL', 'MSFT', 'AMZN', 'TSLA',
                'NVDA', 'META', 'NFLX', 'AMD', 'DIS'
            ];

            useEffect(() => {
                const saved = localStorage.getItem('stockWatchlist');
                if (saved) {
                    setWatchlist(JSON.parse(saved));
                } else {
                    setWatchlist(POPULAR_STOCKS);
                }
            }, []);

            useEffect(() => {
                if (watchlist.length > 0) {
                    localStorage.setItem('stockWatchlist', JSON.stringify(watchlist));
                }
            }, [watchlist]);

            const searchStocks = async (query) => {
                if (!query || query.length < 1) {
                    setSearchResults([]);
                    return;
                }

                setSearching(true);
                try {
                    const response = await fetch(
                        `https://www.alphavantage.co/query?function=SYMBOL_SEARCH&keywords=${query}&apikey=${ALPHA_VANTAGE_KEY}`
                    );
                    const data = await response.json();

                    if (data.bestMatches) {
                        const results = data.bestMatches.map(match => ({
                            symbol: match['1. symbol'],
                            name: match['2. name'],
                            type: match['3. type'],
                            region: match['4. region'],
                            currency: match['8. currency']
                        })).filter(stock => stock.type === 'Equity');
                        setSearchResults(results);
                        setShowSearchResults(true);
                    }
                } catch (error) {
                    console.error('Error searching stocks:', error);
                }
                setSearching(false);
            };

            useEffect(() => {
                const timer = setTimeout(() => {
                    if (searchQuery) {
                        searchStocks(searchQuery);
                    }
                }, 500);
                return () => clearTimeout(timer);
            }, [searchQuery]);

            const fetchStockData = async () => {
                if (watchlist.length === 0) return;

                try {
                    setLoading(true);
                    setError(null);

                    const stocksData = [];

                    for (let i = 0; i < Math.min(watchlist.length, 10); i++) {
                        const symbol = watchlist[i];
                        try {
                            const response = await fetch(
                                `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbol}&apikey=${ALPHA_VANTAGE_KEY}`
                            );
                            const data = await response.json();

                            if (data['Global Quote']) {
                                const quote = data['Global Quote'];
                                stocksData.push({
                                    symbol: symbol,
                                    name: getStockName(symbol),
                                    price: parseFloat(quote['05. price']) || 0,
                                    change: parseFloat(quote['10. change percent']?.replace('%', '')) || 0,
                                    volume: formatVolume(parseInt(quote['06. volume']) || 0)
                                });
                            }

                            if (i < Math.min(watchlist.length, 10) - 1) {
                                await new Promise(resolve => setTimeout(resolve, 12000));
                            }
                        } catch (error) {
                            console.error(`Error fetching ${symbol}:`, error);
                        }
                    }

                    if (stocksData.length > 0) {
                        setStocks(stocksData);
                        setLastUpdate(new Date());
                    } else {
                        throw new Error('No stock data available');
                    }

                    setLoading(false);
                } catch (error) {
                    console.error('Error fetching stock data:', error);
                    setError(error.message);

                    const fallbackData = watchlist.map(symbol => getFallbackStockData(symbol));
                    setStocks(fallbackData);
                    setLastUpdate(new Date());
                    setLoading(false);
                }
            };

            const getStockName = (symbol) => {
                const names = {
                    'AAPL': 'Apple Inc.',
                    'GOOGL': 'Alphabet Inc.',
                    'MSFT': 'Microsoft Corp.',
                    'AMZN': 'Amazon.com Inc.',
                    'TSLA': 'Tesla Inc.',
                    'NVDA': 'NVIDIA Corp.',
                    'META': 'Meta Platforms',
                    'NFLX': 'Netflix Inc.',
                    'AMD': 'Advanced Micro Devices',
                    'DIS': 'Walt Disney Co.'
                };
                return names[symbol] || symbol;
            };

            const formatVolume = (volume) => {
                if (!volume) return 'N/A';
                if (volume >= 1000000000) return `${(volume / 1000000000).toFixed(1)}B`;
                if (volume >= 1000000) return `${(volume / 1000000).toFixed(1)}M`;
                if (volume >= 1000) return `${(volume / 1000).toFixed(1)}K`;
                return volume.toString();
            };

            const getFallbackStockData = (symbol) => {
                const fallbackData = {
                    'AAPL': { price: 178.50, change: 1.2 },
                    'GOOGL': { price: 142.30, change: -0.8 },
                    'MSFT': { price: 378.90, change: 0.9 },
                    'AMZN': { price: 145.60, change: 1.5 },
                    'TSLA': { price: 242.80, change: -2.3 },
                    'NVDA': { price: 495.20, change: 3.2 },
                    'META': { price: 325.40, change: 0.7 },
                    'NFLX': { price: 445.30, change: -1.1 },
                    'AMD': { price: 143.20, change: 2.1 },
                    'DIS': { price: 91.30, change: -0.5 }
                };

                return {
                    symbol,
                    name: getStockName(symbol),
                    price: fallbackData[symbol]?.price || Math.random() * 200 + 50,
                    change: fallbackData[symbol]?.change || (Math.random() - 0.5) * 10,
                    volume: '10.5M'
                };
            };

            const addToWatchlist = (symbol) => {
                if (!watchlist.includes(symbol)) {
                    setWatchlist([...watchlist, symbol]);
                    setSearchQuery('');
                    setShowSearchResults(false);
                }
            };

            const removeFromWatchlist = (symbol) => {
                setWatchlist(watchlist.filter(s => s !== symbol));
                setStocks(stocks.filter(s => s.symbol !== symbol));
            };

            useEffect(() => {
                if (view === 'trading' && watchlist.length > 0) {
                    fetchStockData();
                }
            }, [view]);

            const getCurrentPortfolio = () => {
                if (plan === 'personal') {
                    return competition?.members[0]?.portfolio || { cash: 100000, positions: {}, history: [] };
                }
                const member = competition?.members.find(m => m.id === currentUserId);
                return member?.portfolio || { cash: 100000, positions: {}, history: [] };
            };

            const calculatePortfolioValue = (portfolio) => {
                let positionsValue = 0;
                Object.entries(portfolio.positions).forEach(([symbol, qty]) => {
                    const stock = stocks.find(s => s.symbol === symbol);
                    if (stock) positionsValue += stock.price * qty;
                });
                return portfolio.cash + positionsValue;
            };

            const generateCompetitionCode = () => {
                return Math.random().toString(36).substring(2, 8).toUpperCase();
            };

            const createCompetition = (memberName, contributionAmount) => {
                const code = generateCompetitionCode();
                const memberId = Date.now().toString();

                const newCompetition = {
                    code,
                    totalPool: parseFloat(contributionAmount || 0),
                    startTime: new Date().toISOString(),
                    members: [{
                        id: memberId,
                        name: memberName,
                        contribution: parseFloat(contributionAmount || 0),
                        portfolio: {
                            cash: 100000,
                            positions: {},
                            history: []
                        },
                        joinedAt: new Date().toISOString()
                    }]
                };

                setCompetition(newCompetition);
                setCompetitionCode(code);
                setCurrentUserId(memberId);
                setView('trading');
            };

            const executeTrade = (type) => {
                if (!selectedStock || quantity <= 0) return;

                const stock = stocks.find(s => s.symbol === selectedStock);
                if (!stock) {
                    alert('Stock data not available. Please add to watchlist and refresh.');
                    return;
                }

                const totalCost = stock.price * quantity;
                const portfolio = getCurrentPortfolio();

                if (type === 'buy') {
                    if (totalCost > portfolio.cash) {
                        alert('Insufficient funds!');
                        return;
                    }
                } else {
                    const currentPosition = portfolio.positions[selectedStock] || 0;
                    if (quantity > currentPosition) {
                        alert('Insufficient shares!');
                        return;
                    }
                }

                const updatedPortfolio = {
                    ...portfolio,
                    cash: type === 'buy' ? portfolio.cash - totalCost : portfolio.cash + totalCost,
                    positions: {
                        ...portfolio.positions,
                        [selectedStock]: type === 'buy'
                            ? (portfolio.positions[selectedStock] || 0) + quantity
                            : (portfolio.positions[selectedStock] || 0) - quantity
                    },
                    history: [...portfolio.history, {
                        type,
                        symbol: selectedStock,
                        quantity,
                        price: stock.price,
                        total: totalCost,
                        timestamp: new Date().toISOString()
                    }]
                };

                setCompetition(prev => ({
                    ...prev,
                    members: prev.members.map(m =>
                        m.id === currentUserId ? { ...m, portfolio: updatedPortfolio } : m
                    )
                }));

                setQuantity(1);
            };

            // Plan Selection Screen
            if (view === 'plan-select') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-900 via-blue-700 to-blue-900 p-4 md:p-8">
                        <div className="max-w-7xl mx-auto">
                            <div className="text-center mb-12 pt-8">
                                <div className="flex items-center justify-center mb-6">
                                    <div className="bg-gradient-to-r from-cyan-400 to-blue-400 p-4 rounded-2xl shadow-2xl">
                                        <span className="text-6xl">📈</span>
                                    </div>
                                </div>
                                <h1 className="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-cyan-300 to-blue-300 mb-4">
                                    TradeWars
                                </h1>
                                <p className="text-xl text-blue-100">Master the markets. Compete with family. Win real money.</p>
                            </div>

                            <div className="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto">
                                <div className="group relative bg-gradient-to-br from-blue-800 to-blue-900 rounded-3xl p-8 border border-blue-600 hover:border-cyan-400 transition-all duration-300">
                                    <div className="flex items-center justify-center mb-6">
                                        <div className="bg-gradient-to-br from-cyan-400 to-blue-500 p-4 rounded-2xl">
                                            <span className="text-5xl">👤</span>
                                        </div>
                                    </div>

                                    <h2 className="text-3xl font-bold text-white text-center mb-4">Personal Plan</h2>

                                    <div className="text-center mb-6">
                                        <span className="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-green-300 to-emerald-400">FREE</span>
                                    </div>

                                    <ul className="space-y-3 mb-8 text-blue-100">
                                        <li>✅ $100,000 virtual capital</li>
                                        <li>✅ Trade any stock globally</li>
                                        <li>✅ Custom watchlists</li>
                                        <li>✅ Risk-free practice</li>
                                    </ul>

                                    <button
                                        onClick={() => {
                                            setPlan('personal');
                                            setView('setup-family');
                                        }}
                                        className="w-full bg-gradient-to-r from-cyan-400 to-blue-500 text-white py-4 rounded-xl font-bold text-lg hover:from-cyan-300 hover:to-blue-400 transition-all duration-300"
                                    >
                                        Start Free Trading
                                    </button>
                                </div>

                                <div className="group relative bg-gradient-to-br from-purple-800 to-indigo-900 rounded-3xl p-8 border border-purple-600">
                                    <div className="flex items-center justify-center mb-6">
                                        <div className="bg-gradient-to-br from-purple-400 to-pink-500 p-4 rounded-2xl">
                                            <span className="text-5xl">👥</span>
                                        </div>
                                    </div>

                                    <h2 className="text-3xl font-bold text-white text-center mb-4">Family Plan</h2>

                                    <div className="text-center mb-6">
                                        <span className="text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-300 to-orange-400">COMPETE</span>
                                    </div>

                                    <ul className="space-y-3 mb-8 text-purple-100">
                                        <li>🏆 Private competitions</li>
                                        <li>💰 Real money prizes</li>
                                        <li>📊 Live leaderboards</li>
                                        <li>🎯 Winner takes all</li>
                                    </ul>

                                    <div className="grid grid-cols-2 gap-4">
                                        <button
                                            onClick={() => {
                                                setPlan('family');
                                                setView('setup-family');
                                            }}
                                            className="bg-gradient-to-r from-purple-400 to-pink-500 text-white py-4 rounded-xl font-bold"
                                        >
                                            Create Pool
                                        </button>
                                        <button
                                            onClick={() => {
                                                setPlan('family');
                                                setView('join-family');
                                            }}
                                            className="bg-blue-700 text-white py-4 rounded-xl font-bold"
                                        >
                                            Join Pool
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // Setup/Join screens
            if (view === 'setup-family' || view === 'join-family') {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-900 via-blue-700 to-blue-900 p-4 md:p-8">
                        <div className="max-w-2xl mx-auto">
                            <button
                                onClick={() => setView('plan-select')}
                                className="mb-6 text-cyan-300 hover:text-cyan-200 font-semibold"
                            >
                                ← Back to Plans
                            </button>

                            <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-3xl p-8 border border-blue-600">
                                <h2 className="text-4xl font-bold text-white mb-8 text-center">
                                    {view === 'setup-family' ? (plan === 'personal' ? 'Setup Personal Trading' : 'Create Competition') : 'Join Competition'}
                                </h2>

                                <div className="space-y-6">
                                    <div>
                                        <label className="block text-blue-100 font-semibold mb-2">Your Name</label>
                                        <input
                                            type="text"
                                            value={userName}
                                            onChange={(e) => setUserName(e.target.value)}
                                            placeholder="Enter your name"
                                            className="w-full bg-blue-700/50 border border-blue-500 rounded-xl px-4 py-3 text-white placeholder-blue-300"
                                        />
                                    </div>

                                    {plan === 'family' && (
                                        <div>
                                            <label className="block text-blue-100 font-semibold mb-2">Entry Amount ($)</label>
                                            <input
                                                type="number"
                                                value={contribution}
                                                onChange={(e) => setContribution(e.target.value)}
                                                placeholder="0.00"
                                                className="w-full bg-blue-700/50 border border-blue-500 rounded-xl px-4 py-3 text-white text-2xl font-bold placeholder-blue-300"
                                            />
                                        </div>
                                    )}

                                    <button
                                        onClick={() => {
                                            if (!userName) {
                                                alert('Please enter your name');
                                                return;
                                            }
                                            if (plan === 'personal') {
                                                createCompetition(userName, 0);
                                            } else if (!contribution || parseFloat(contribution) <= 0) {
                                                alert('Please enter a valid contribution amount');
                                                return;
                                            } else {
                                                createCompetition(userName, contribution);
                                            }
                                        }}
                                        className="w-full bg-gradient-to-r from-cyan-400 to-blue-500 text-white py-4 rounded-xl font-bold text-lg"
                                    >
                                        {view === 'setup-family' ? (plan === 'personal' ? 'Start Trading' : 'Create Competition') : 'Join Competition'}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            // Trading Interface
            const portfolio = getCurrentPortfolio();
            const portfolioValue = calculatePortfolioValue(portfolio);
            const portfolioReturn = ((portfolioValue - 100000) / 100000) * 100;

            const filteredStocks = stocks.filter(stock =>
                stock.symbol.toLowerCase().includes(searchTerm.toLowerCase()) ||
                stock.name.toLowerCase().includes(searchTerm.toLowerCase())
            );

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-900 via-blue-700 to-blue-900 p-4">
                    <div className="max-w-7xl mx-auto">
                        {/* Header */}
                        <div className="bg-gradient-to-r from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600 mb-6">
                            <div className="flex justify-between items-center">
                                <div>
                                    <h1 className="text-3xl font-bold text-white flex items-center gap-2">
                                        📊 {plan === 'personal' ? 'Personal Trading' : 'Family Competition'}
                                    </h1>
                                    <p className="text-blue-200">{userName}</p>
                                </div>
                                {competition?.code && (
                                    <div className="bg-blue-700/50 rounded-xl px-6 py-3 border border-blue-500">
                                        <div className="text-xs text-blue-200">Competition Code</div>
                                        <div className="text-2xl font-bold text-white tracking-wider">{competition.code}</div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Stats */}
                        <div className="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
                            <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                <div className="text-blue-200 text-sm font-semibold mb-2">💵 Cash</div>
                                <div className="text-3xl font-bold text-white">${portfolio.cash.toLocaleString(undefined, {maximumFractionDigits: 0})}</div>
                            </div>

                            <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                <div className="text-blue-200 text-sm font-semibold mb-2">📈 Portfolio Value</div>
                                <div className="text-3xl font-bold text-white">${portfolioValue.toLocaleString(undefined, {maximumFractionDigits: 0})}</div>
                            </div>

                            <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                <div className="text-blue-200 text-sm font-semibold mb-2">📊 Return</div>
                                <div className={`text-3xl font-bold ${portfolioReturn >= 0 ? 'text-green-300' : 'text-red-300'}`}>
                                    {portfolioReturn >= 0 ? '+' : ''}{portfolioReturn.toFixed(2)}%
                                </div>
                            </div>

                            <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                <div className="text-blue-200 text-sm font-semibold mb-2">⭐ Watchlist</div>
                                <div className="text-3xl font-bold text-white">{watchlist.length}</div>
                            </div>
                        </div>

                        {/* Main Content */}
                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            {/* Market View */}
                            <div className="lg:col-span-2 bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                <h2 className="text-2xl font-bold text-white mb-4">🔍 Stock Search</h2>

                                <input
                                    type="text"
                                    placeholder="Search stocks (e.g., AAPL, TSLA)..."
                                    value={searchQuery}
                                    onChange={(e) => setSearchQuery(e.target.value)}
                                    className="w-full bg-blue-700/50 border border-blue-500 rounded-xl px-4 py-3 text-white placeholder-blue-300 mb-6"
                                />

                                {showSearchResults && searchResults.length > 0 && (
                                    <div className="mb-6 bg-blue-800 border border-blue-600 rounded-xl max-h-60 overflow-y-auto">
                                        {searchResults.map((result) => (
                                            <div
                                                key={result.symbol}
                                                onClick={() => addToWatchlist(result.symbol)}
                                                className="p-4 hover:bg-blue-700 cursor-pointer border-b border-blue-700"
                                            >
                                                <div className="font-bold text-white">{result.symbol}</div>
                                                <div className="text-sm text-blue-200">{result.name}</div>
                                            </div>
                                        ))}
                                    </div>
                                )}

                                <h3 className="text-lg font-bold text-white mb-4">⭐ My Watchlist</h3>

                                {loading && stocks.length === 0 ? (
                                    <div className="text-center py-12">
                                        <div className="text-blue-200">Loading stocks...</div>
                                    </div>
                                ) : (
                                    <div className="space-y-2">
                                        {filteredStocks.map(stock => (
                                            <div
                                                key={stock.symbol}
                                                onClick={() => setSelectedStock(stock.symbol)}
                                                className={`p-4 rounded-xl cursor-pointer transition-all ${
                                                    selectedStock === stock.symbol
                                                        ? 'bg-cyan-400/20 border-2 border-cyan-400'
                                                        : 'bg-blue-700/30 border border-blue-500 hover:bg-blue-700/50'
                                                }`}
                                            >
                                                <div className="flex justify-between items-center">
                                                    <div>
                                                        <div className="font-bold text-xl text-white">{stock.symbol}</div>
                                                        <div className="text-sm text-blue-200">{stock.name}</div>
                                                    </div>
                                                    <div className="text-right">
                                                        <div className="font-bold text-2xl text-white">${stock.price.toFixed(2)}</div>
                                                        <div className={`text-sm font-bold ${stock.change >= 0 ? 'text-green-300' : 'text-red-300'}`}>
                                                            {stock.change >= 0 ? '↗' : '↘'} {stock.change >= 0 ? '+' : ''}{stock.change.toFixed(2)}%
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                )}
                            </div>

                            {/* Trading Panel */}
                            <div className="space-y-6">
                                {selectedStock ? (
                                    <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                        <div className="mb-6">
                                            <h2 className="text-3xl font-bold text-white">{selectedStock}</h2>
                                            <p className="text-blue-200">{stocks.find(s => s.symbol === selectedStock)?.name}</p>
                                        </div>

                                        <div className="mb-6">
                                            <div className="text-4xl font-bold text-white mb-2">
                                                ${stocks.find(s => s.symbol === selectedStock)?.price.toFixed(2)}
                                            </div>
                                            <div className={`text-lg font-semibold ${
                                                stocks.find(s => s.symbol === selectedStock)?.change >= 0 ? 'text-green-300' : 'text-red-300'
                                            }`}>
                                                {stocks.find(s => s.symbol === selectedStock)?.change >= 0 ? '+' : ''}
                                                {stocks.find(s => s.symbol === selectedStock)?.change.toFixed(2)}%
                                            </div>
                                        </div>

                                        <div className="mb-6">
                                            <label className="block text-blue-200 font-semibold mb-2">Quantity</label>
                                            <div className="flex gap-2">
                                                <button
                                                    onClick={() => setQuantity(Math.max(1, quantity - 1))}
                                                    className="bg-blue-700 text-white w-12 h-12 rounded-xl font-bold text-2xl"
                                                >
                                                    -
                                                </button>
                                                <input
                                                    type="number"
                                                    min="1"
                                                    value={quantity}
                                                    onChange={(e) => setQuantity(Math.max(1, parseInt(e.target.value) || 1))}
                                                    className="flex-1 bg-blue-700/50 border border-blue-500 rounded-xl px-4 py-3 text-white text-center text-xl font-bold"
                                                />
                                                <button
                                                    onClick={() => setQuantity(quantity + 1)}
                                                    className="bg-blue-700 text-white w-12 h-12 rounded-xl font-bold text-2xl"
                                                >
                                                    +
                                                </button>
                                            </div>
                                        </div>

                                        <div className="mb-6 p-4 bg-blue-700/30 border border-blue-500 rounded-xl">
                                            <div className="flex justify-between text-white font-bold text-lg">
                                                <span>Total Cost:</span>
                                                <span>${(stocks.find(s => s.symbol === selectedStock)?.price * quantity).toFixed(2)}</span>
                                            </div>
                                        </div>

                                        <div className="grid grid-cols-2 gap-4">
                                            <button
                                                onClick={() => executeTrade('buy')}
                                                className="bg-gradient-to-r from-green-400 to-emerald-500 text-white py-4 rounded-xl font-bold text-lg"
                                            >
                                                ➕ Buy
                                            </button>
                                            <button
                                                onClick={() => executeTrade('sell')}
                                                className="bg-gradient-to-r from-red-500 to-pink-600 text-white py-4 rounded-xl font-bold text-lg"
                                            >
                                                ➖ Sell
                                            </button>
                                        </div>
                                    </div>
                                ) : (
                                    <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                        <div className="text-center py-12">
                                            <div className="text-6xl mb-4">📈</div>
                                            <p className="text-blue-200 text-lg">Select a stock to trade</p>
                                        </div>
                                    </div>
                                )}

                                {/* Portfolio Positions */}
                                <div className="bg-gradient-to-br from-blue-800 to-blue-900 rounded-2xl p-6 border border-blue-600">
                                    <h3 className="text-xl font-bold text-white mb-4">💼 Your Positions</h3>
                                    <div className="space-y-2">
                                        {Object.entries(portfolio.positions).filter(([_, qty]) => qty > 0).length === 0 ? (
                                            <div className="text-center py-6 text-blue-300">No positions yet</div>
                                        ) : (
                                            Object.entries(portfolio.positions)
                                                .filter(([_, qty]) => qty > 0)
                                                .map(([symbol, qty]) => {
                                                    const stock = stocks.find(s => s.symbol === symbol);
                                                    if (!stock) return null;
                                                    const value = stock.price * qty;
                                                    return (
                                                        <div key={symbol} className="bg-blue-700/30 border border-blue-500 rounded-xl p-3">
                                                            <div className="flex justify-between items-center">
                                                                <div>
                                                                    <div className="font-bold text-white">{symbol}</div>
                                                                    <div className="text-sm text-blue-200">{qty} shares</div>
                                                                </div>
                                                                <div className="text-right">
                                                                    <div className="font-bold text-white">${value.toFixed(2)}</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    );
                                                })
                                        )}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<TradingSimulator />);
    </script>
</body>
</html>
